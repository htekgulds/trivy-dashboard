import { useQuery } from '@tanstack/react-query'
import axios from 'axios'

async function getTrivyVulnerabilityReports (ns) {
  const res = await axios.get('/api/trivy/reports', {
    params: { ns, type: ReportTypes.VULNERABILITY, limit: 1000 }
  })

  return res.data
}

export default function useVulnerabilityReports (namespace) {
  return useQuery({
    queryKey: ['trivyVulnerabilityReports', namespace],
    queryFn: () => getTrivyVulnerabilityReports(namespace)
  })
}
